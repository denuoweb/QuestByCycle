<div id="submissionDetailModal" class="modal" data-current-user-id="{{ current_user.id }}" data-is-admin="{{ current_user.is_admin }}">
  <div class="modal-content">

    <!-- ── TOP BAR: Submitted by + Like + Close ── -->
    <div class="modal-header d-flex justify-content-between align-items-center">
      <!-- left -->
      <div class="d-flex align-items-center">
        <span class="submitter-label me-2">Submitted by:</span>
        <a id="submitterProfileLink" href="#" class="d-flex align-items-center">
          <span class="submitter-profile-frame--inline">
            <img
              id="submitterProfileImage"
              src="{{ placeholder_image }}"
              alt="Submitter Profile"
            >
          </span>
          <span id="submitterProfileCaption" class="submitter-profile-caption ms-2">—</span>
        </a>
      </div>

      <!-- right -->
      <div class="d-flex align-items-center">
        <button id="prevSubmissionBtn" class="btn btn-icon me-2" aria-label="Previous submission" title="Previous">
          <i class="fas fa-chevron-left"></i>
        </button>
        <button id="submissionLikeBtn" class="btn btn-icon me-2">
          <i class="fas fa-heart"></i>
          <span id="submissionLikeCount">0</span>
        </button>
        <button id="nextSubmissionBtn" class="btn btn-icon me-2" aria-label="Next submission" title="Next">
          <i class="fas fa-chevron-right"></i>
        </button>
        <button type="button" class="btn-close" aria-label="Close"
                data-close-modal="submissionDetailModal"></button>
      </div>
    </div>

    <!-- Skinny subheader: Quest selector -->
    <div class="px-3 py-1" style="border-bottom: 1px solid #eee;">
      <div class="d-flex align-items-center" style="gap: 8px; font-size: 0.9rem;">
        <span class="text-muted">Quest:</span>
        <select id="submissionQuestSelect" class="form-select form-select-sm" style="max-width: 420px;">
          <!-- options injected dynamically -->
        </select>
      </div>
    </div>
    <!-- ── IMAGE + single overlayed profile frame ── -->
    <div id="submissionImageContainer" class="mb-4">
      <span class="submitter-profile-frame">
        <img id="submitterProfileImageOverlay"
             src="{{ placeholder_image }}"
             alt="Submitter Profile">
      </span>
      <img id="submissionImage"
           class="verification-image"
           src="{{ placeholder_image }}"
           alt="Submission Detail">
      <video id="submissionVideo" class="verification-video" controls hidden>
        <source id="submissionVideoSource" src="" type="video/mp4">
      </video>
      <button id="editPhotoBtn" class="btn btn-outline-secondary btn-sm mt-2" hidden>
        Change
      </button>
      <button id="deleteSubmissionBtn" class="btn btn-danger btn-sm mt-2 ms-2" hidden>
        Delete
      </button>

      <!-- hidden file-picker + controls -->
      <div id="photoEditControls" class="mt-2" hidden>
        <input type="file" id="submissionPhotoInput" accept="image/*,video/*" />
        <button id="savePhotoBtn" class="btn btn-primary btn-sm ms-2">Save</button>
        <button id="cancelPhotoBtn" class="btn btn-secondary btn-sm ms-1">Cancel</button>
      </div>
    </div>

    <!-- ── TWO-COLUMN: Owner Comment ⬅️ Replies & Reply Box ➡️ ── -->
    <div class="submission-body d-flex gap-4">
      <!-- Left column: owner’s comment -->
      <div class="submission-owner-comment flex-fill">
        <h4>Submission Comment:</h4>
        <p id="submissionComment" class="comment-text mb-2">No comment provided.</p>
        <div id="commentReadButtons" class="mb-2">
          <button id="editCommentBtn"
                  class="btn btn-outline-secondary btn-sm"
                  hidden>Edit</button>
        </div>
        <textarea id="submissionCommentEdit"
                  class="form-control mb-2"
                  rows="3"
                  hidden></textarea>
        <div id="commentEditButtons" hidden>
          <button id="saveCommentBtn" class="btn btn-primary btn-sm me-2">Update</button>
          <button id="cancelCommentBtn" class="btn btn-secondary btn-sm">Cancel</button>
        </div>
      </div>

      <!-- Right column: replies + reply box -->
      <div id="submissionRepliesContainer" class="submission-replies flex-fill d-flex flex-column">
        <h4>Leave a Comment:</h4>
        <div id="submissionRepliesList" class="mb-3 flex-grow-1 overflow-auto">
          <!-- replies injected here -->
        </div>
        <div id="ownerNotice" class="text-muted mb-2" hidden>
          Submitters cannot comment on their own submission.
        </div>
        <textarea id="submissionReplyEdit"
                  class="form-control mb-2"
                  rows="2"
                  maxlength="1000"
                  placeholder="Leave a comment…"></textarea>
        <div id="replyLimitMessage" class="text-muted mt-2 d-none">
          Maximum replies reached, sorry.
        </div>
        <button id="postReplyBtn"
                class="btn btn-primary btn-sm align-self-end">Post Reply</button>
      </div>
    </div>

    <!-- ── FOOTER: social links ── -->
    <div class="text-center mt-4">
      <a id="twitterLink"   class="btn btn-link" target="_blank" href="#">Twitter</a>
      <a id="facebookLink"  class="btn btn-link" target="_blank" href="#">Facebook</a>
      <a id="instagramLink" class="btn btn-link" target="_blank" href="#">Instagram</a>
    </div>

  </div>
</div>
