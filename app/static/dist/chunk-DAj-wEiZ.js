const C="modulepreload",S=function(e){return"/static/dist/"+e},b={},_=function(t,n,o){let s=Promise.resolve();if(n&&n.length>0){let r=function(i){return Promise.all(i.map(u=>Promise.resolve(u).then(w=>({status:"fulfilled",value:w}),w=>({status:"rejected",reason:w}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),h=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));s=r(n.map(i=>{if(i=S(i),i in b)return;b[i]=!0;const u=i.endsWith(".css"),w=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${w}`))return;const m=document.createElement("link");if(m.rel=u?"stylesheet":C,u||(m.as="script"),m.crossOrigin="",m.href=i,h&&m.setAttribute("nonce",h),document.head.appendChild(m),u)return new Promise((L,B)=>{m.addEventListener("load",L),m.addEventListener("error",()=>B(new Error(`Unable to preload CSS for ${i}`)))})}))}function d(r){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=r,window.dispatchEvent(a),!a.defaultPrevented)throw r}return s.then(r=>{for(const a of r||[])a.status==="rejected"&&d(a.reason);return t().catch(d)})},c={log:(...e)=>console.log(...e),error:(...e)=>console.error(...e),warn:(...e)=>console.warn(...e),info:(...e)=>console.info(...e),debug:(...e)=>console.debug(...e)};let p=3e3,E=0;function l(e){var o;const t=document.getElementById(e);if(!t){c.error(`Modal ${e} not found`);return}document.body.appendChild(t),(o=document.querySelector(".container"))==null||o.classList.add("modal-open"),E=window.scrollY||window.pageYOffset,document.body.style.top=`-${E}px`,document.body.style.position="fixed",t.classList.add("active"),t.style.display="flex",p+=10,t.style.zIndex=p;const n=t.querySelector(".modal-backdrop");n&&(n.style.display="block",n.style.zIndex=p-1),document.body.classList.add("body-no-scroll")}function y(e){var o;const t=document.getElementById(e);if(!t)return;const n=t.querySelector(".modal-backdrop");t.style.display="none",n&&(n.style.display="none"),p=Math.max(1050,p-10),document.querySelector('.modal[style*="display: flex"]')||(document.body.classList.remove("body-no-scroll"),(o=document.querySelector(".container"))==null||o.classList.remove("modal-open"),document.body.style.position="",document.body.style.top="",window.scrollTo(0,E)),t.dispatchEvent(new CustomEvent("hidden.bs.modal",{bubbles:!0}))}function A(){const e=document.getElementById("twitterLink");e&&(e.style.display="none",e.href="#");const t=document.getElementById("facebookLink");t&&(t.style.display="none",t.href="#");const n=document.getElementById("instagramLink");n&&(n.style.display="none",n.href="#");const o=document.getElementById("modalQuestActions");o&&(o.innerHTML=""),document.querySelectorAll('[id^="verifyButton-"]').forEach(s=>s.remove()),document.querySelectorAll('[id^="verifyQuestForm-"]').forEach(s=>s.remove()),document.body.classList.remove("body-no-scroll")}function v(e={}){const t=document.getElementById("registerForm"),n=t.getAttribute("action").split("?")[0],o=[];e.gameId&&o.push(`game_id=${encodeURIComponent(e.gameId)}`),e.questId&&o.push(`quest_id=${encodeURIComponent(e.questId)}`),e.next&&o.push(`next=${encodeURIComponent(e.next)}`),e.showJoinCustom!==void 0&&o.push(`show_join_custom=${encodeURIComponent(e.showJoinCustom)}`),t.setAttribute("action",n+(o.length?`?${o.join("&")}`:"")),e.gameId!==void 0&&(document.getElementById("registerGameId").value=e.gameId),e.questId!==void 0&&(document.getElementById("registerQuestId").value=e.questId),e.next!==void 0&&(document.getElementById("registerNext").value=e.next),e.showJoinCustom!==void 0&&(document.getElementById("registerShowJoinCustom").value=e.showJoinCustom),y("loginModal"),l("registerModal")}function I({gameId:e,questId:t="",nextPath:n=null}){const o=document.getElementById("loginForm"),s=document.getElementById("loginGameId"),d=document.getElementById("loginQuestId"),r=document.getElementById("loginNext"),a=document.getElementById("loginShowJoinCustom"),h=n??`/?game_id=${encodeURIComponent(e)}&show_join_custom=0`;s.value=e,d.value=t,a.value="0",r.value=h;const i=o.getAttribute("action").split("?")[0],u=new URLSearchParams({game_id:e,quest_id:t,show_join_custom:0,next:h});o.setAttribute("action",`${i}?${u.toString()}`),l("loginModal")}function P(){const e=document.getElementById("loginGameId").value||"",t=document.getElementById("loginQuestId").value||"",n=document.getElementById("loginNext").value||"",o=document.getElementById("loginShowJoinCustom").value||"",s=(document.getElementById("loginCustomGameCode")||{}).value||"";document.getElementById("registerGameId").value=e,document.getElementById("registerQuestId").value=t,document.getElementById("registerNext").value=n,document.getElementById("registerShowJoinCustom").value=o,document.getElementById("registerCustomGameCode").value=s;const d=document.getElementById("registerForm"),r=d.getAttribute("action").split("?")[0],a=new URLSearchParams;e&&a.set("game_id",e),t&&a.set("quest_id",t),n&&a.set("next",n),o&&a.set("show_join_custom",o),s&&a.set("custom_game_code",s),d.setAttribute("action",`${r}?${a.toString()}`),y("loginModal"),l("registerModal")}function U(){var d;const e=((d=document.getElementById("loginEmail"))==null?void 0:d.value)||"",t=document.getElementById("forgotEmail");t&&(t.value=e);const n=document.getElementById("forgotEmailError"),o=document.getElementById("forgotSuccess"),s=document.getElementById("forgotButton");n&&(n.style.display="none"),o&&(o.style.display="none"),s&&(s.disabled=!1),l("forgotPasswordModal")}function x(e){const t=document.getElementById("resetForm"),n=document.getElementById("resetToken"),o=t.dataset.baseAction;t.setAttribute("action",o+encodeURIComponent(e)),n.value=e,document.getElementById("resetError").style.display="none",document.getElementById("resetSuccess").style.display="none",document.getElementById("resetButton").disabled=!1,l("resetPasswordModal")}document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search);if(e.get("show_reset")==="1"){const t=e.get("token");t?(x(t),history.replaceState(null,"",window.location.pathname)):c.warn("show_reset=1 present but no token in URL")}});document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search),t=e.get("show_join_custom")==="1",n=e.has("game_id");t&&!n&&l("joinCustomGameModal")});document.addEventListener("DOMContentLoaded",()=>{const t=new URLSearchParams(window.location.search).get("quest_shortcut");t&&(_(()=>import("./chunk-DbtdAp9d.js").then(n=>n.q),[]).then(n=>n.openQuestDetailModal(t)),history.replaceState(null,"",window.location.pathname))});document.addEventListener("DOMContentLoaded",()=>{const e=new URLSearchParams(window.location.search);if(!(e.get("show_login")==="1"))return;const n=e.get("next")||"";let o=e.get("game_id")||"";if(!o&&n)try{const d=new URL(n,window.location.origin).pathname.replace(/^\/+/,"");/^\d+$/.test(d)&&(o=d)}catch(s){c.warn("Failed to parse next URL for gameId:",s)}I({gameId:o,questId:"",nextPath:n})});document.addEventListener("DOMContentLoaded",()=>{if(!window.location.pathname.startsWith("/auth/login"))return;const e=new URLSearchParams(window.location.search),t=e.get("next");if(!t)return;let n=e.get("game_id")||"";if(!n)try{const s=new URL(t,window.location.origin).pathname.replace(/^\/+/,"");/^\d+$/.test(s)&&(n=s)}catch(o){c.warn("Could not parse next URL for gameId:",o)}n&&I({gameId:n,questId:"",nextPath:t})});async function k(e,t){try{const n=await fetch(e,{credentials:"same-origin"});if(!n.ok)throw new Error(`HTTP ${n.status}`);const o=await n.text(),s=document.getElementById(t);s&&s.parentNode.removeChild(s);const d=document.createElement("div");d.innerHTML=o.trim();const r=d.firstElementChild;(!r||r.id!==t)&&c.warn(`Expected first element to be #${t}`,r),document.body.appendChild(r),l(t)}catch(n){c.error(`Error loading ${t} from ${e}:`,n),alert("Failed to load data. Please try again later.")}}async function $(e){const t=await fetch(e.action,{method:e.method||"POST",headers:{"X-Requested-With":"XMLHttpRequest"},body:new FormData(e),credentials:"same-origin"});if(!(t.headers.get("content-type")||"").includes("application/json"))return window.location.href=t.url,{status:t.status,json:{}};const o=await t.json();return{status:t.status,json:o}}document.addEventListener("click",e=>{const t=e.target.closest("[data-close-modal]");if(!t)return;e.preventDefault();const n=t.getAttribute("data-close-modal");n&&y(n)});document.addEventListener("click",e=>{const t=e.target.closest("[data-open-modal]");t&&(e.preventDefault(),l(t.getAttribute("data-open-modal")))});document.addEventListener("click",e=>{const t=e.target.closest("[data-login-game]");if(!t)return;e.preventDefault();const n=t.getAttribute("data-login-game"),o=`/?game_id=${encodeURIComponent(n)}&show_join_custom=0`;v({gameId:n,showJoinCustom:0,next:o})});document.addEventListener("keydown",e=>{const t=e.target.closest("[data-login-game]");if(t&&(e.key==="Enter"||e.key===" ")){e.preventDefault();const n=t.getAttribute("data-login-game"),o=`/?game_id=${encodeURIComponent(n)}&show_join_custom=0`;v({gameId:n,showJoinCustom:0,next:o})}});document.addEventListener("click",e=>{var d,r,a;if(!e.target.closest("[data-open-login-from-register]"))return;e.preventDefault();const n=((d=document.getElementById("registerGameId"))==null?void 0:d.value)||"",o=((r=document.getElementById("registerQuestId"))==null?void 0:r.value)||"",s=((a=document.getElementById("registerNext"))==null?void 0:a.value)||"";y("registerModal"),I({gameId:n,questId:o,nextPath:s})});document.addEventListener("click",e=>{const t=e.target.closest("[data-modal-url]");if(!t)return;e.preventDefault();const n=t.getAttribute("data-modal-url"),o=t.getAttribute("data-modal-id");if(!n||!o){c.error("data-modal-url or data-modal-id missing",t);return}k(n,o)});document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".modal").forEach(e=>{e.parentNode!==document.body&&document.body.appendChild(e)})});function M(){const e=document.querySelector('meta[name="csrf-token"]');return e?e.getAttribute("content"):""}async function R(e,t={}){const n={Accept:"application/json",...t.headers||{}},o={credentials:"same-origin",cache:"no-store",...t,headers:n},s=await fetch(e,o),d=await s.json().catch(()=>({}));return{status:s.status,json:d}}async function j(e,t={}){const n={...t.headers||{}};return n["X-CSRF-Token"]=M(),R(e,{...t,headers:n})}let g=0,f=null;function q(e){const t=document.getElementById("loadingStatus");t&&typeof e=="string"&&(t.textContent=e)}function D(e=null){e&&q(e),g===0&&(c.debug("Showing loading modal"),l("loadingModal")),g+=1,f&&clearTimeout(f),f=setTimeout(()=>{c.warn("Loading modal auto-hide triggered after timeout."),g=0,y("loadingModal")},3e4)}function F(){g>0&&(g-=1),g===0&&(c.debug("Hiding loading modal"),f&&(clearTimeout(f),f=null),y("loadingModal"))}export{_,D as a,y as b,j as c,U as d,A as e,R as f,M as g,F as h,c as l,l as o,P as r,$ as s};
